---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('posts', ({ data }) => {
  return data.lang === 'en' && !data.draft;
});

// Extract all unique tags
const allTags = [...new Set(posts.flatMap(post => post.data.tag || []))].sort();
---

<BaseLayout title="Tags" description="Browse posts by tag">
  <div class="container py-8">
    <header class="mb-12">
      <h1 class="text-3xl md:text-4xl font-bold">Tags</h1>
      <p class="text-secondary mt-2">Browse posts by tag</p>
    </header>

    {allTags.length === 0 ? (
      <p class="text-secondary">No tags yet.</p>
    ) : (
      <div class="flex flex-wrap gap-3">
        {allTags.map(tag => (
          <a
            href={`/tags/${tag.toLowerCase()}`}
            class="px-4 py-2 bg-surface border border-border rounded-full hover:border-accent transition-colors"
          >
            #{tag}
          </a>
        ))}
      </div>
    )}
  </div>
</BaseLayout>
